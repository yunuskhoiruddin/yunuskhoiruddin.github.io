<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vue.js API Request Example</title>
  </head>
  <body>

    <!-- Tambahkan div sebagai tempat untuk aplikasi Vue -->
    <div id="app">
      <router-view :users="users"></router-view>
    </div>

    <!-- Sertakan Vue.js -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
    <!-- Sertakan Vue Router -->
    <script src="https://cdn.jsdelivr.net/npm/vue-router@3"></script>
    <!-- Sertakan library Axios untuk melakukan HTTP request -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <script>
    // Fungsi untuk melakukan request data dari JSON
    async function fetchData() {
      try {
        const response = await axios.get('https://jsonplaceholder.typicode.com/users');
        return response.data;
      } catch (error) {
        console.error('Error fetching data:', error);
        throw error;
      }
    }

    const UserList = {
      template: `
        <div>
          <h1>Data dari API:</h1>

          <!-- Tampilkan loading jika sedang melakukan request -->
          <div v-if="loading">Loading...</div>

          <!-- Tampilkan data jika sudah diterima -->
          <ul v-if="!loading && users">
            <li v-for="user in users" :key="user.id">
              <router-link :to="{ name: 'user-detail', params: { id: user.id }}">{{ user.name }}</router-link>
            </li>
          </ul>
        </div>
      `,
      props: ['users'],
      data() {
        return {
          loading: true // Menandakan status loading
        };
      },
      mounted() {
        // Set loading menjadi false setelah mendapatkan data dari prop
        this.loading = false;
      }
    };


    // Komponen untuk menampilkan detail pengguna
    const UserDetail = {
      template: `
        <div>
          <h2>Detail Pengguna</h2>
          <p>Nama Pengguna: {{ user.name }}</p>
          <p>Email: {{ user.email }}</p>
          <p>Telepon: {{ user.phone }}</p>
        </div>
      `,
      props: ['users'],
      computed: {
        user() {
          // Ambil data pengguna berdasarkan ID dari URL
          const userId = this.$route.params.id;
          return this.users.find(user => user.id == userId);
        }
      }
    };

    // Inisialisasi Vue Router
    const router = new VueRouter({
      routes: [
        { path: '/', component: UserList },
        { path: '/user/:id', name: 'user-detail', component: UserDetail }
      ]
    });

    // Inisialisasi aplikasi Vue
    new Vue({
      el: '#app',
      router,
      data() {
        return {
          users: [] // Menampung data dari API
        };
      },
      async mounted() {
        // Panggil fungsi untuk melakukan request API saat komponen di-mount
        try {
          this.users = await fetchData();
        } catch (error) {
          // Handle error jika request gagal
        }
      }
    });
  </script>

  </body>
</html>
